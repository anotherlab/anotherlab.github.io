<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>It’s 2013, stop trying to write to the Program Files folder already - Chris Miller’s 4th Blog</title>
<meta name="description" content="Type to Learn&#8217;s login screen">


  <meta name="author" content="Chris Miller">
  
  <meta property="article:author" content="Chris Miller">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Chris Miller's 4th Blog">
<meta property="og:title" content="It’s 2013, stop trying to write to the Program Files folder already">
<meta property="og:url" content="http://localhost:4000/2013/12/18/its-2013-stop-trying-to-write-to-the-program-files-folder-already/">


  <meta property="og:description" content="Type to Learn&#8217;s login screen">





  <meta name="twitter:site" content="@anotherlab">
  <meta name="twitter:title" content="It’s 2013, stop trying to write to the Program Files folder already">
  <meta name="twitter:description" content="Type to Learn&#8217;s login screen">
  <meta name="twitter:url" content="http://localhost:4000/2013/12/18/its-2013-stop-trying-to-write-to-the-program-files-folder-already/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2013-12-18T00:12:31-05:00">






<link rel="canonical" href="http://localhost:4000/2013/12/18/its-2013-stop-trying-to-write-to-the-program-files-folder-already/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Chris Miller",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Chris Miller's 4th Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



<!-- Twitter cards -->
<meta name="twitter:site"    content="@anotherlab">
<meta name="twitter:creator" content="@">
<meta name="twitter:title"   content="It&#8217;s 2013, stop trying to write to the Program Files folder already">


<meta name="twitter:description" content="My personal blog, 4th version">




<meta name="twitter:card"  content="summary">
<meta name="twitter:image" content="https://assets.about.me/background/users/t/h/i/thisischrismiller_1488935098_536.jpg">


<!-- end of Twitter cards -->
    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--post">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Chris Miller's 4th Blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">It&amp;#8217;s 2013, stop trying to write to the Program Files folder already</h1>
    <p class="post-meta"><time class="dt-published" datetime="2013-12-18T00:12:31-05:00" itemprop="datePublished">
        Dec 18, 2013
      </time></p>
      
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div style="width: 235px" class="wp-caption alignleft">
  <a href="http://ttl4.sunburst.com/"><img loading="lazy" class=" " alt="Type To Learn" src="https://i2.wp.com/www.rajapet.net/photos/i-Hxz98hj/0/S/i-Hxz98hj-S.jpg?resize=225%2C180" width="225" height="180" /></a>
  
  <p class="wp-caption-text">
    Type to Learn&#8217;s login screen
  </p>
</div>

<p>My daughter asked if I could install <a href="http://ttl4.sunburst.com/index.php">Type to Learn 4</a>, an app that she uses at school.  It provides a fun way to learn typing skills. If a school buys the app, they can provide student accounts and the student can download and install the app at home.</p>

<p>She, of course, had not told me any of this.  I went to the web site for Type To Learn and saw that there were two versions.  A School Login Portal, and the home version.  So I clicked on the home version which took me to Amazon.</p>

<div style="width: 129px" class="wp-caption alignleft">
  <a href="http://www.amazon.com/dp/B004LC3VCW"><img loading="lazy" alt="" src="https://i0.wp.com/www.rajapet.net/photos/i-GsjhW8Z/0/O/i-GsjhW8Z.png?resize=119%2C121" width="119" height="121" /></a>
  
  <p class="wp-caption-text">
    No middle ground
  </p>
</div>

<p>The first thing I saw was the 2.5 out 5 star rating.  That’s not a good sign.  It was an inverse bell curve, people either loved it or hated it.  When you see numbers like that, you read the 1 star reviews to see what went wrong.</p>

<p>I zeroed in on the comment posted <a href="http://www.amazon.com/review/RP9QLB2RDN16Y/ref=cm_cr_rdp_perm?ie=UTF8&amp;ASIN=B004LC3VCW&amp;linkCode=&amp;nodeID=&amp;tag=">here</a>.  That user had determined that Type To Learn was trying to write data back to a data file located in it ‘s program folder (<strong>C:\program files (x86)\sunburst</strong>). That’s not a good thing.</p>

<p><span style="line-height: 1.5;"> Unless you had admin rights, that’s going to fail.  Starting with Windows Vista, standard users can’t write to any folders in the </span><strong style="line-height: 1.5;">Program Files</strong> <span style="line-height: 1.5;">or </span><strong style="line-height: 1.5;">Program Files (x86)</strong> <span style="line-height: 1.5;">space.  Just not allowed.  You can write to those folders if you have admin rights.  </span></p>

<p><span style="line-height: 1.5;">My kids don’t have admin rights on the home PC’s.  They don’t need them and keeps the PC running smoothly.  Under normal usage, only setup applications should be writing to <strong>Program Files</strong>.</span></p>

<p>There is also the multiple user situation. If you are writing to one location and you have multiple user accounts on the machine, the you need to make sure that your saved data is multiuser friendly.</p>

<blockquote>
  <p>As it turned out, we didn’t need to buy the app from Amazon, we could just download the app from the School Login Portal.  But we still would have the same problem the data being written back to <strong>Program Files (x86)</strong>.</p>
</blockquote>

<p>Where are you supposed to put your application data?  For desktop applications, you have two choices.  Shared data goes into a folder under <strong>%PROGRAMDATA%</strong>, which usually maps to a hidden root folder name ‘<strong>ProgramData</strong>“.</p>

<p>User specific data should go into  <strong>%APPDATA%</strong> or <strong>%LOCALAPPDATA%</strong>.  Under Windows 8.1, <strong>APPDATA</strong> maps to something like <strong>c:\users\username\appdata\roaming</strong>.  This is used for data shared across multiple machines. <strong>LOCALAPPDATA</strong> maps to <strong>c:\users\username\appdata\local</strong> and is where you would store user data for that machine.</p>

<p>So we have an app writing to the verboten <strong>Program Files</strong> folder.  We can’t change that behavior, but we can allow it to work for a non-admin user without disabling all of the security.  We just need to everyone full access to that folder.</p>

<p>I like to do stuff like that from the command line. When messing around with access rights, I want to be explicit with what I am setting.  That’s just the way I roll.  With that, our tool is the trusty <a href="http://technet.microsoft.com/en-us/library/cc753525.aspx">Icacls</a> command.</p>

<p>Icacls is used for setting user and group access to a folder.  It does more than that, but if you don’t have an IT background. the rest of what it does will make your eyes bleed.  I mean the /verify parameter is documented to “Finds all files with ACLs that are not canonical or have lengths inconsistent with ACE (access control entry) counts.”.  You don’t need to know what that means, trust me.</p>

<p>Here’s what you need to know:</p>

<p>Run cmd.exe as administrator.  With Windows 8/8.1, this is easy.  From the Metro screen (Yes, I know. I still call it Metro), just type “cmd” and right click on “Command Prompt” and select “Run as administrator.  It should look like this:</p>

<p><img loading="lazy" class="aligncenter" alt="Run as adminitratpr" src="https://i2.wp.com/www.rajapet.net/photos/i-M4kjZMP/0/S/i-M4kjZMP-S.png?resize=243%2C300" width="243" height="300" /></p>

<p>When that cmd window opens up, CD into “<strong>c:\program files (x86)</strong>“. That will save you from having to type “c:\program files (x86)” over and over again.</p>

<p>[Edit]<br />
A <a href="http://tvug.net/post/March-Meeting-Building-Your-First-Windows-Phone-8-Application">cricket player from Eastern Europe</a> sent in the following tip:</p>

<blockquote>
  <p>An even easier way to launch an admin cmd prompt is Win+X then A. It’s the newest keyboard shortcut forever burned into my memory.</p>
</blockquote>

<p>Now run</p>

<pre>icacls sunburst</pre>

<p>Sunburst is the company that makes or sells Type To Learn, all of the files are in that folder.  You should see the following:</p>

<p><a href="https://i1.wp.com/www.rajapet.net/photos/i-LhvQXRC/0/O/i-LhvQXRC.png"><img loading="lazy" class="aligncenter" alt="" src="https://i0.wp.com/www.rajapet.net/photos/i-LhvQXRC/0/M/i-LhvQXRC-M.png?resize=600%2C304" width="600" height="304" /></a></p>

<p>That tells us that the TrustedInstaller (i.e. setup programs) and admins have full rights to that folder, every one else has read access</p>

<p>Now run</p>

<pre>icacls sunburst /grant Everyone:(OI)(CI)F</pre>

<p>In human speak, that means give (<strong>/grant</strong>) everyone full access (<strong>F</strong>) to the sunburst folder and all of the files (<strong>(OI)</strong>) in that folder and all of the folders (<strong>(CI)</strong>) in the sunburst folder. Then run “icacls sunburst” again to verify that the change took effect.  It should look like this</p>

<p><a href="https://i2.wp.com/www.rajapet.net/photos/i-wwzKrMP/0/O/i-wwzKrMP.png"><img loading="lazy" class="aligncenter" alt="" src="https://i2.wp.com/www.rajapet.net/photos/i-wwzKrMP/0/M/i-wwzKrMP-M.png?resize=600%2C304" width="600" height="304" /></a></p>

<p>You should see that everone has full rights to that folder. Now you can run Type To Learn as  standard user.</p>

  </div><a class="u-url" href="/2013/12/18/its-2013-stop-trying-to-write-to-the-program-files-folder-already/" hidden></a>
</article>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/anotherlab" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/anotherlab" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/christophermiller/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://instagram.com/anotherlab" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
        
          <li><a href="https://mvp.microsoft.com/en-us/PublicProfile/5000200" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-award" aria-hidden="true"></i> Microsoft MVP</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Chris Miller. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <script>
  'use strict';

  (function () {
    var commentContainer = document.querySelector('#giscus-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://giscus.app/client.js');
    script.setAttribute('data-repo', 'anotherlab/anotherlab.github.io');
    script.setAttribute('data-repo-id', '');
    script.setAttribute('data-category', '');
    script.setAttribute('data-category-id', '');
    script.setAttribute('data-mapping', 'pathname');
    script.setAttribute('data-reactions-enabled', '1');
    script.setAttribute('data-theme', 'light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>
  





  </body>
</html>
