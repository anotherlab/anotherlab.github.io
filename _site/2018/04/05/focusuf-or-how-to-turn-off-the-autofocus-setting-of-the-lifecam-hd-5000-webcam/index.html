<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>FocusUF or how to turn off the autofocus setting of the LifeCam HD-5000 webcam | Chris Miller’s 4th Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="FocusUF or how to turn off the autofocus setting of the LifeCam HD-5000 webcam" />
<meta name="author" content="Chris Miller" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Welcome to the FuzzyCam" />
<meta property="og:description" content="Welcome to the FuzzyCam" />
<link rel="canonical" href="http://localhost:4000/2018/04/05/focusuf-or-how-to-turn-off-the-autofocus-setting-of-the-lifecam-hd-5000-webcam/" />
<meta property="og:url" content="http://localhost:4000/2018/04/05/focusuf-or-how-to-turn-off-the-autofocus-setting-of-the-lifecam-hd-5000-webcam/" />
<meta property="og:site_name" content="Chris Miller’s 4th Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-05T21:41:39-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="FocusUF or how to turn off the autofocus setting of the LifeCam HD-5000 webcam" />
<script type="application/ld+json">
{"datePublished":"2018-04-05T21:41:39-04:00","@type":"BlogPosting","url":"http://localhost:4000/2018/04/05/focusuf-or-how-to-turn-off-the-autofocus-setting-of-the-lifecam-hd-5000-webcam/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2018/04/05/focusuf-or-how-to-turn-off-the-autofocus-setting-of-the-lifecam-hd-5000-webcam/"},"dateModified":"2018-04-05T21:41:39-04:00","author":{"@type":"Person","name":"Chris Miller"},"description":"Welcome to the FuzzyCam","headline":"FocusUF or how to turn off the autofocus setting of the LifeCam HD-5000 webcam","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Chris Miller's 4th Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chris Miller&#39;s 4th Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">FocusUF or how to turn off the autofocus setting of the LifeCam HD-5000 webcam</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-04-05T21:41:39-04:00" itemprop="datePublished">Apr 5, 2018
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Chris Miller</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div style="width: 409px" class="wp-caption alignnone">
  <img loading="lazy" class="size-medium" src="https://i0.wp.com/photos.smugmug.com/photos/i-BgcrnZW/0/7d3ad5c8/S/i-BgcrnZW-S.jpg?resize=399%2C225&#038;ssl=1" width="399" height="225" data-recalc-dims="1" />
  
  <p class="wp-caption-text">
    Welcome to the FuzzyCam
  </p>
</div>

<p>Note from the future: I updated the code and blogged about it <a href="https://rajapet.com/2020/03/20/return-to-focusuf/">here</a>.</p>

<p>Why am I out of focus? It’s because I have a Microsoft LifeCam HD-5000 and I’m running Windows 10. The LifeCam HD-5000 webcam is a decent webcam with an annoying feature. The autofocus keeps shifting the focus around if you move your head slightly. It goes in and out of focus and locks in after a second or two.  When you are in a video chat, this can get very annoying (very quickly) for the other viewers. Your face will shift in and out of focus and it’s just a distraction.  Microsoft used to supply drivers for the HD-5000 and it had a control app where you could adjust the focus settings. Since Windows 8, they stopped as the OS directly supported the webcam.</p>

<p>I’m not able to sit motionless while on a webcam. I needed a work around. There is a registry hack that lets you turn off autofocus. I prefer to avoid hacks like that when it’s something that I could code around. So after seeing <a href="https://stackoverflow.com/questions/18124646/manually-focus-camera-in-emgu-cv/18189027#18189027">some stuff on StackOverflow</a> on how to use the IAMCameraControl interface in DirectShow, I wrote a tiny command line app called FocusUF.</p>

<p>FocusUF uses the <a href="https://www.nuget.org/packages/DirectShowLib/" rel="nofollow">DirectShowLib library</a> library to provide nice, friendly C# access to DirectShow. The DirectShowLib library maps the DirectShow Interfaces for use from a .NET app. With that library, it was little more than a handful of lines of code to access webcam controls. The app is hard coded to connect to a LifeCam HD-5000, but it would be easy enough to change the code for other webcam.</p>

<p>The code was written with Visual Studio 2017, it has not been tested with any other compiler. The source code is up on GitHub via this <a href="https://github.com/anotherlab/FocusUF">handy little URL</a>.</p>

<h2 id="how-it-works">How it works</h2>

<p>To use the DirectShowLib library, I added it via nuget.</p>

<p><code class="language-plaintext highlighter-rouge">Install-Package DirectShowLib</code></p>

<p>The next step was to get access to the webcam. Using DsDevice from DirectShowLib, I was able to get the list of devices for the category of VideoInputDevice. Then I do a LINQ query to filter that list for the first match “Microsoft® LifeCam HD-5000”. If you are having a autofocus problem with a different brand or model of webcam, just replace that name with the name of your webcam. You can dump out the list of DsDevices and peek at the name property until you see your webcam.</p>

<p>Now that I have a DirectShow  sDevice that represents the webcam, I create a filter to expose the control interface of the web cam. DirectShow uses a module system called filters to expose device functionality. I create a new object that implements the IFilterGraph2 interface so that we can add a new filter. After getting that filter, I cast it to an IAMCameraControl to get access to the setter and getter methods. I get the current focus level and mode from the webcam.  I then set the focus to the current level and force the focus mode to manual.</p>

<h2 id="how-to-use"><a id="user-content-how-to-use" class="anchor" href="https://github.com/anotherlab/FocusUF/blob/master/README.md#how-to-use" aria-hidden="true"></a>How to use</h2>

<p>Launch the app that will be using the webcam. Wait until it is in focus and then run FocusUF. It will detect the webcam and flip the autofocus setting to manual and lock it to the current focus setting. The setting will persist until the webcam is reset or another app changes the focus setting.</p>

<div style="width: 409px" class="wp-caption alignnone">
  <img loading="lazy" class="size-medium" src="https://i2.wp.com/photos.smugmug.com/photos/i-8ZMBJkS/0/07d4a10a/S/i-8ZMBJkS-S.jpg?resize=399%2C225&#038;ssl=1" width="399" height="225" data-recalc-dims="1" />
  
  <p class="wp-caption-text">
    I probably looked better out of focus&#8230;
  </p>
</div>

<p>The name “FocusUF” is a tip of the hat to the YouTube channel <a href="https://www.youtube.com/user/arduinoversusevil/featured" rel="nofollow">AvE</a>, where the host uses the phrase “Focus You F@*&amp;” whenever his video camera loses focus.</p>

  </div><a class="u-url" href="/2018/04/05/focusuf-or-how-to-turn-off-the-autofocus-setting-of-the-lifecam-hd-5000-webcam/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chris Miller&#39;s 4th Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chris Miller&#39;s 4th Blog</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">anotherlab</span></a></li><li><a href="https://www.twitter.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">anotherlab</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
