<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>What to do when a Windows 7 desktop icon has the wrong image | Chris Miller’s 4th Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="What to do when a Windows 7 desktop icon has the wrong image" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We are in the middle of rebranding our applications and as part of the rebranding, the icons for each application have been updated.  We are having lots of fun cramming Vista styled icons through ancient resource compilers, but that’s another story." />
<meta property="og:description" content="We are in the middle of rebranding our applications and as part of the rebranding, the icons for each application have been updated.  We are having lots of fun cramming Vista styled icons through ancient resource compilers, but that’s another story." />
<link rel="canonical" href="http://localhost:4000/2010/02/25/what-to-do-when-windows-7-desktop-icon/" />
<meta property="og:url" content="http://localhost:4000/2010/02/25/what-to-do-when-windows-7-desktop-icon/" />
<meta property="og:site_name" content="Chris Miller’s 4th Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-02-25T21:58:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="What to do when a Windows 7 desktop icon has the wrong image" />
<script type="application/ld+json">
{"datePublished":"2010-02-25T21:58:00-05:00","@type":"BlogPosting","url":"http://localhost:4000/2010/02/25/what-to-do-when-windows-7-desktop-icon/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2010/02/25/what-to-do-when-windows-7-desktop-icon/"},"dateModified":"2010-02-25T21:58:00-05:00","description":"We are in the middle of rebranding our applications and as part of the rebranding, the icons for each application have been updated.  We are having lots of fun cramming Vista styled icons through ancient resource compilers, but that’s another story.","headline":"What to do when a Windows 7 desktop icon has the wrong image","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Chris Miller's 4th Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chris Miller&#39;s 4th Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">What to do when a Windows 7 desktop icon has the wrong image</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2010-02-25T21:58:00-05:00" itemprop="datePublished">Feb 25, 2010
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>We are in the middle of rebranding our applications and as part of the rebranding, the icons for each application have been updated.  We are having lots of fun cramming Vista styled icons through ancient resource compilers, but that’s another story.</p>

<p>We provided a rebranded application to our QA tem for testing.  The first thing the QA manager did was to drag the app to her Windows 7 desktop, replacing the previous version.   Oddly enough, the image appeared for the icon.  I went back and checked the build process, that image was no longer there.  yet, it appeared on her desktop.  It also occurs with Vista as well.</p>

<p>I had originally posted how to do this by deleting the iconcach.db, but that is such a crude hack that I have pulled it.  After posting this message, I came across a much simpler mechanism. </p>

<p>If you call <span><a title="MSDN: SHChangeNotify Function" href="http://msdn.microsoft.com/en-us/library/bb762118%28VS.85%29.aspx">SHChangeNotify(SHCNE_UPDATEDIR, SHCNF_IDLIST, 0, 0)</a>, from shell32.dll, this will cause the icon cache to be refreshed.  This happens in real time, no need to restart explorer or rebooting.  This is easy to call from just about every programming environment. If you need a stand alone app,  Helge Klien wrote a simple command line tool and posted it at <a title="Free Tool: Refresh the Desktop Programmatically" href="http://blogs.sepago.de/helge/2007/11/22/free-tool-refresh-the-desktop-programmatically/">Free Tool: Refresh the Desktop Programmatically</a>.  I’ve added the SHChangeNotify() call to my installers, the users will never be bothered by this.</span></p>

  </div><a class="u-url" href="/2010/02/25/what-to-do-when-windows-7-desktop-icon/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chris Miller&#39;s 4th Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chris Miller&#39;s 4th Blog</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">anotherlab</span></a></li><li><a href="https://www.twitter.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">anotherlab</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
