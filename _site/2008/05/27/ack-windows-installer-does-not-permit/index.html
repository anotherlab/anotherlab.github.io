<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Ack! The Windows Installer does not permit installation from a Remote Desktop Connection - Chris Miller’s 4th Blog</title>
<meta name="description" content="I’m testing a installer that I had migrated from Wise For Windows to InstallAware. I testing the installer from inside a virtual machine. I used do it with VMware Workstation, but now I’m using virtual machines hosted on our ESX server. That’s usually much faster and doesn’t my bog down my development machine.">


  <meta name="author" content="Chris Miller">
  
  <meta property="article:author" content="Chris Miller">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Chris Miller's 4th Blog">
<meta property="og:title" content="Ack! The Windows Installer does not permit installation from a Remote Desktop Connection">
<meta property="og:url" content="http://localhost:4000/2008/05/27/ack-windows-installer-does-not-permit/">


  <meta property="og:description" content="I’m testing a installer that I had migrated from Wise For Windows to InstallAware. I testing the installer from inside a virtual machine. I used do it with VMware Workstation, but now I’m using virtual machines hosted on our ESX server. That’s usually much faster and doesn’t my bog down my development machine.">





  <meta name="twitter:site" content="@anotherlab">
  <meta name="twitter:title" content="Ack! The Windows Installer does not permit installation from a Remote Desktop Connection">
  <meta name="twitter:description" content="I’m testing a installer that I had migrated from Wise For Windows to InstallAware. I testing the installer from inside a virtual machine. I used do it with VMware Workstation, but now I’m using virtual machines hosted on our ESX server. That’s usually much faster and doesn’t my bog down my development machine.">
  <meta name="twitter:url" content="http://localhost:4000/2008/05/27/ack-windows-installer-does-not-permit/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  <meta property="article:published_time" content="2008-05-27T19:45:00-04:00">






<link rel="canonical" href="http://localhost:4000/2008/05/27/ack-windows-installer-does-not-permit/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Chris Miller",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Chris Miller's 4th Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--post">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Chris Miller's 4th Blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Ack! The Windows Installer does not permit installation from a Remote Desktop Connection</h1>
    <p class="post-meta"><time class="dt-published" datetime="2008-05-27T19:45:00-04:00" itemprop="datePublished">
        May 27, 2008
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I’m testing a installer that I had migrated from Wise For Windows to <a href="http://www.installaware.com/">InstallAware</a>. I testing the installer from inside a virtual machine. I used do it with VMware Workstation, but now I’m using virtual machines hosted on our <a href="http://info.vmware.com/content/GLP_ESX_LP1">ESX</a> server. That’s usually much faster and doesn’t my bog down my development machine.</p>

<p>I connected to a virtual Server 2003 session using <a href="http://www.codeplex.com/Terminals">Terminals</a>. If you spend anymore of time using Remote Desktop, then you’ll want Terminals. It lets you have multiple sessions open in a single instance of the client by displaying each session in a tab. In addition to RDP, it supports VNC, Telnet/SSH, and a few other protocols. And it’s an open source project, you can’t beat the price tag.</p>

<p>With a RDP connection, you have the ability to automagically have the remote connection access your local resources (drives, printers, serial ports, etc). I was using the local access to disks to allow the remote connection to access my hard drive. I figured that would be a quick way to compile the installer on my local machine and run it remotely through the RDP connection.</p>

<p>Or so I thought. As a prerequisite for this app, I need to install the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=ca9d90fa-e8c9-42e3-aa19-08e2c027f5d6&amp;displaylang=en">ASP.NET 2.0 AJAX Extensions</a>. That comes as a Windows Installer .msi files. When I ran that .msi, I got the following error message:</p>

<p><a href="https://i1.wp.com/2.bp.blogspot.com/_natoSxTaPFU/SDxYaWpSIQI/AAAAAAAAAE4/EEAxORsgzoY/s1600-h/WindowsInstallerError.png"><img src="https://i0.wp.com/2.bp.blogspot.com/_natoSxTaPFU/SDxYaWpSIQI/AAAAAAAAAE4/EEAxORsgzoY/s400/WindowsInstallerError.png?w=680" alt="" border="0" data-recalc-dims="1" /></a></p>

<p><a href="http://www.blogger.com/%24WindowsInstallerError.png"><br />
</a></p>

<p>In other words: <a href="http://www.jonco48.com/blog/fail_20at_20failing.jpg">FAIL</a>. To add insult to injury, that’s not even a standard Windows error dialog. With most Windows error dialog boxes, you can press Ctrl-C and the contents of the dialog box will be copied to the clipboard. You’ll get all of the information from the dialog, something like this (from a different installer):&lt;/p&gt;</p>

<pre>---------------------------<br />Microsoft .NET Framework 2.0 SP1 Setup<br />---------------------------<br />The Windows Installer package:

<p>
  
</p>

<br />

<p>
  c:\c6b28b8b6e56383fbc455e9977dd00\vs_setup.msi
</p>

<br />

<p>
  could not be opened.
</p>

<br />

<p>
  
</p>

<br />

<p>
  Choose Retry to try again. Choose Cancel for exit setup.<br />---------------------------<br />Retry   Cancel<br />---------------------------<br />
</p></pre>

<p>That’s very handy for reporting errors or for researching with the text from the dialog. I hate it when I see a bug logged in our internal bug tracking system that has embedded a screen shot of an error message. They screen shot the whole page (hello? Alt-Prtscn anyone), save the image, then attach it as a file attachment. Instead, they have press CTRL-C and then CTRL-V and be done with it. Rant over, back to original rant.</p>

<p>For some reason, the AJAX installer team chose not to follow that convention. So I went to Google and manually typed in the text of the error message (<a href="http://www.flickr.com/photos/ulrichp/1362599/">Oh, the huge manatee!</a>) and start viewing the results. Sure enough, it’s in the MS Knowledge base as <a href="http://support.microsoft.com/kb/927063" title="Error message when you try to install a MSI package on a Windows Server 2003-based computer by using RDP connection: &quot;Windows Installer does not permit installation from a Remote Desktop Connection&quot;">927063</a>. Windows Installer does not allow installs in Server 2003 from a RDP connection shared drive. When you allow access to your local C: drive to the remote session, it sees it as <a href="file://%5C%5Ctsclient%5Cc/">\TSClient\c</a> and flat out disallows installs from anything in the <a href="file://%5C%5Ctsclient/">\TSClient</a> namespace. This was determined to be a security risk and the tssclient blocking was added Windows Installer 2.0 at the time of the Windows Server 2003 release.</p>

<p>This KB article lists two resolutions, use the standard UNC notation to reference that drive or map a drive letter to that location. To that list, I’ll a third option. Copy the file from the <a href="file://%5C%5Ctsclient/">\tsclient</a> share to the remote desktop and run it from there. For one off tasks, that’s usually faster than accessing a UNC named object.</p>

<p>Side note: While writing this post, I read on the Terminals home page on CodePlex that Microsoft will be removing the ability to connect to the console session through the RDP protocol in version 6.1. Being able to connect to the console is a little known feature of the RDP client, mstsc.exe. I use it when people leave their RDP sessions hanging on a 2003 Server box that only has the admin remote connections enabled. I can connect over the console session and blow away the left over sessions. I can <a href="http://anotherlab.rajapet.net/2008/04/how-to-identify-who-has-terminal.html" title="How to identify who has a terminal session and how to kill it">query and kill the remote sessions via the command line</a>, but sometimes you just need one session open. If you want to see this feature left in the RDP stack, place your vote <a href="https://connect.microsoft.com/WindowsServerFeedback/feedback/ViewFeedback.aspx?FeedbackID=341289" title="Feedback: RDC : ConnectToServerConsole vs ConnectToAdministerServer">here</a>.</p>

  </div><a class="u-url" href="/2008/05/27/ack-windows-installer-does-not-permit/" hidden></a>
</article>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/anotherlab" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/anotherlab" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://instagram.com/anotherlab" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
        
          <li><a href="https://mvp.microsoft.com/en-us/PublicProfile/5000200" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-award" aria-hidden="true"></i> Microsoft MVP</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Chris Miller. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', '');
    script.setAttribute('issue-term', 'pathname');
    
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  





  </body>
</html>
