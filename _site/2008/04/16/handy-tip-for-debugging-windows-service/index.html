<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Handy tip for debugging a Windows Service | Chris Miller’s 4th Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Handy tip for debugging a Windows Service" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Debugging a Windows Service is always a pain. You can’t run a service like a regular application, you have to run it from Windows Service Control Manager (SCM) and then have your debugger attach to the process while it’s running. The problem is that it’s difficult to debug problems with the service startup as the debugger can’t attach to the service in time." />
<meta property="og:description" content="Debugging a Windows Service is always a pain. You can’t run a service like a regular application, you have to run it from Windows Service Control Manager (SCM) and then have your debugger attach to the process while it’s running. The problem is that it’s difficult to debug problems with the service startup as the debugger can’t attach to the service in time." />
<link rel="canonical" href="http://localhost:4000/2008/04/16/handy-tip-for-debugging-windows-service/" />
<meta property="og:url" content="http://localhost:4000/2008/04/16/handy-tip-for-debugging-windows-service/" />
<meta property="og:site_name" content="Chris Miller’s 4th Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-04-16T21:21:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Handy tip for debugging a Windows Service" />
<script type="application/ld+json">
{"datePublished":"2008-04-16T21:21:00-04:00","@type":"BlogPosting","url":"http://localhost:4000/2008/04/16/handy-tip-for-debugging-windows-service/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2008/04/16/handy-tip-for-debugging-windows-service/"},"dateModified":"2008-04-16T21:21:00-04:00","description":"Debugging a Windows Service is always a pain. You can’t run a service like a regular application, you have to run it from Windows Service Control Manager (SCM) and then have your debugger attach to the process while it’s running. The problem is that it’s difficult to debug problems with the service startup as the debugger can’t attach to the service in time.","headline":"Handy tip for debugging a Windows Service","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Chris Miller's 4th Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chris Miller&#39;s 4th Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Handy tip for debugging a Windows Service</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-04-16T21:21:00-04:00" itemprop="datePublished">Apr 16, 2008
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Debugging a Windows Service is always a pain. You can’t run a service like a regular application, you have to run it from Windows Service Control Manager (SCM) and then have your debugger attach to the process while it’s running. The problem is that it’s difficult to debug problems with the service startup as the debugger can’t attach to the service in time.</p>

<p>I came across a tip on the <a href="http://dotnettipoftheday.org/">.NET Tip of The Day</a> site, <a href="http://dotnettipoftheday.org/tips/how-to-debug-windows-service-startup.aspx">“How to debug Windows Service startup”</a>. Basically, you just add a line that calls <a href="http://msdn2.microsoft.com/en-us/library/system.diagnostics.debugger.launch.aspx" title="MSDN: Launches and attaches a debugger to the process.">Debugger.Launch()</a> or <a href="http://msdn2.microsoft.com/en-us/library/system.diagnostics.debugger.break.aspx" title="MSDN: Signals a breakpoint to an attached debugger.">Debugger.Break()</a> in your startup code. When your code hits one of those lines, the Visual Studio Just-In-Time Debugger dialog will be invoked and you can select your debugger to handle the error. That will allow you to continue along in the code and debug until the cows come home.</p>

<p>That works better than a service debugging <a href="http://anotherlab.rajapet.net/2005/11/debugging-services.html">tip</a> I posted a couple of years back, calling the Sleep API in your startup code to allow enough time to attach a debugger to the service. That was a hack, this is much cleaner.</p>

<p>All in all, I still prefer to separate the functional code from the service specific code. I can then run that code from a desktop app, making it much easier to debug. That works about 99.9% of time. Every now and then, I do need to run the actual service code and the Debugger.XXXX() calls will make that task much easier.</p>

  </div><a class="u-url" href="/2008/04/16/handy-tip-for-debugging-windows-service/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chris Miller&#39;s 4th Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chris Miller&#39;s 4th Blog</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">anotherlab</span></a></li><li><a href="https://www.twitter.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">anotherlab</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
