<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>When to use cursors | Chris Miller’s 4th Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="When to use cursors" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is cool &lt;a href=”http://anotherlab.rajapet.net/” http: title=”Running sums, redux”&gt;article&lt;/a&gt; that describes a good reason for using cursors. The knee jerk reaction from most SQL Gurus is usually “Cursors bad, sets good”. But there are times where it actually makes sense to use a cursor over set logic. Adam Machanic describes a few ways to generate a running sum of one of the columns of data in a record set. His gut reaction was to use varies combinations of self-joins, but the performance was hideous. For each row, you have to sum the values of all of the rows preceding, the performance cost is exponential to the size of the result set." />
<meta property="og:description" content="This is cool &lt;a href=”http://anotherlab.rajapet.net/” http: title=”Running sums, redux”&gt;article&lt;/a&gt; that describes a good reason for using cursors. The knee jerk reaction from most SQL Gurus is usually “Cursors bad, sets good”. But there are times where it actually makes sense to use a cursor over set logic. Adam Machanic describes a few ways to generate a running sum of one of the columns of data in a record set. His gut reaction was to use varies combinations of self-joins, but the performance was hideous. For each row, you have to sum the values of all of the rows preceding, the performance cost is exponential to the size of the result set." />
<link rel="canonical" href="http://localhost:4000/2006/02/28/when-to-use-cursors/" />
<meta property="og:url" content="http://localhost:4000/2006/02/28/when-to-use-cursors/" />
<meta property="og:site_name" content="Chris Miller’s 4th Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2006-02-28T15:28:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="When to use cursors" />
<script type="application/ld+json">
{"datePublished":"2006-02-28T15:28:00-05:00","@type":"BlogPosting","url":"http://localhost:4000/2006/02/28/when-to-use-cursors/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2006/02/28/when-to-use-cursors/"},"dateModified":"2006-02-28T15:28:00-05:00","description":"This is cool &lt;a href=”http://anotherlab.rajapet.net/” http: title=”Running sums, redux”&gt;article&lt;/a&gt; that describes a good reason for using cursors. The knee jerk reaction from most SQL Gurus is usually “Cursors bad, sets good”. But there are times where it actually makes sense to use a cursor over set logic. Adam Machanic describes a few ways to generate a running sum of one of the columns of data in a record set. His gut reaction was to use varies combinations of self-joins, but the performance was hideous. For each row, you have to sum the values of all of the rows preceding, the performance cost is exponential to the size of the result set.","headline":"When to use cursors","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Chris Miller's 4th Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chris Miller&#39;s 4th Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">When to use cursors</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2006-02-28T15:28:00-05:00" itemprop="datePublished">Feb 28, 2006
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>This is cool &lt;a href=”http://anotherlab.rajapet.net/” http: title=”Running sums, redux”&gt;article&lt;/a&gt; that describes a good reason for using cursors. The knee jerk reaction from most SQL Gurus is usually “Cursors bad, sets good”. But there are times where it actually makes sense to use a cursor over set logic. <a href="http://www.sqljunkies.com/WebLog/amachanic/default.aspx">Adam Machanic</a> describes a few ways to generate a running sum of one of the columns of data in a record set. His gut reaction was to use varies combinations of self-joins, but the performance was hideous. For each row, you have to sum the values of all of the rows preceding, the performance cost is exponential to the size of the result set.</p>

<p>When he rewrote the query to use a cursor, the performance was dramaticly better, each row only needed to be read once. The performance cost was linear to the number of rows read.</p>

<p>If you stand back and look at the big picture, you may still want to avoid the cursor and just accumulate the running total in the code that is calling the query. That may prove to be the fastest way to execute this type of query.</p>

  </div><a class="u-url" href="/2006/02/28/when-to-use-cursors/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chris Miller&#39;s 4th Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chris Miller&#39;s 4th Blog</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">anotherlab</span></a></li><li><a href="https://www.twitter.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">anotherlab</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
