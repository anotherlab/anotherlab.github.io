<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Fun with scripted load tests | Chris Miller’s 4th Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Fun with scripted load tests" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We are getting ready to do some load tests and it’s time to pick some tools.  The app that we want to test is a client/server app with buckets of processing going on the client side.  Most c/s load test tools just emulate the traffic that goes on between the client and the server.  For our app, that wont work, the load occurs on both the client and the app and we have to drive the app.  This means one instance of the app per PC.  We have tried multiple instances of the app on the desktop or through multiple terminal service sessions, but that just didn’t work.  We tried that a couple of years ago at at the Microsoft testing facility in Waltham, MA, but it only would work as one app per machine." />
<meta property="og:description" content="We are getting ready to do some load tests and it’s time to pick some tools.  The app that we want to test is a client/server app with buckets of processing going on the client side.  Most c/s load test tools just emulate the traffic that goes on between the client and the server.  For our app, that wont work, the load occurs on both the client and the app and we have to drive the app.  This means one instance of the app per PC.  We have tried multiple instances of the app on the desktop or through multiple terminal service sessions, but that just didn’t work.  We tried that a couple of years ago at at the Microsoft testing facility in Waltham, MA, but it only would work as one app per machine." />
<link rel="canonical" href="http://localhost:4000/2006/06/13/fun-with-scripted-load-tests/" />
<meta property="og:url" content="http://localhost:4000/2006/06/13/fun-with-scripted-load-tests/" />
<meta property="og:site_name" content="Chris Miller’s 4th Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2006-06-13T19:03:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fun with scripted load tests" />
<script type="application/ld+json">
{"datePublished":"2006-06-13T19:03:00-04:00","@type":"BlogPosting","url":"http://localhost:4000/2006/06/13/fun-with-scripted-load-tests/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2006/06/13/fun-with-scripted-load-tests/"},"dateModified":"2006-06-13T19:03:00-04:00","description":"We are getting ready to do some load tests and it’s time to pick some tools.  The app that we want to test is a client/server app with buckets of processing going on the client side.  Most c/s load test tools just emulate the traffic that goes on between the client and the server.  For our app, that wont work, the load occurs on both the client and the app and we have to drive the app.  This means one instance of the app per PC.  We have tried multiple instances of the app on the desktop or through multiple terminal service sessions, but that just didn’t work.  We tried that a couple of years ago at at the Microsoft testing facility in Waltham, MA, but it only would work as one app per machine.","headline":"Fun with scripted load tests","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Chris Miller's 4th Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chris Miller&#39;s 4th Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fun with scripted load tests</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2006-06-13T19:03:00-04:00" itemprop="datePublished">Jun 13, 2006
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>We are getting ready to do some load tests and it’s time to pick some tools.  The app that we want to test is a client/server app with buckets of processing going on the client side.  Most c/s load test tools just emulate the traffic that goes on between the client and the server.  For our app, that wont work, the load occurs on both the client and the app and we have to drive the app.  This means one instance of the app per PC.  We have tried multiple instances of the app on the desktop or through multiple terminal service sessions, but that just didn’t work.  We tried that a couple of years ago at at the <a href="http://www.microsoft.com/mscorp/info/usaoffices/newengland/waltham.mspx">Microsoft testing facility</a> in Waltham, MA, but it only would work as one app per machine.</p>

<p>So we will just do that here in the office.  Some night, after everyone goes home, we’ll log into each desktop with a special login (limited access) and run our tests.  We are evaluating <a href="http://www.vtsoft.com/products/HT.html">HighTest Plus</a>, from Vermont Creative Software.  It’s an automated software testing tool that allows you to record and playback keyboard/mouse actions.  What we want to do is to setup a repository of scripts and have a set of PCs run the scripts.  The fun part is how to start each testing session without having to walk over to each machine and login and then run the script.</p>

<p>I first looked into somehow getting each machine to login into the testing account.  There’s no easy way to remotely script this.  For security reasons, you have to use the keyboard and/or mouse with the login dialog, you can’t bypass that with a script invoked from another machine.   We didn’t want to install any remote access software like <a href="http://www.realvnc.com/">VNC</a> or pcAnywhere.  It would cost too much and we didn’t want to leave anything running on the machines during business hours.  That leaves <a href="http://www.microsoft.com/windowsxp/using/mobility/getstarted/remoteintro.mspx">Remote Desktop</a>.  You can script the <a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/ts_cmd_mstsc.mspx?mfr=true">mstsc.exe</a> client so that you can feed in the login infomation.  So we started with that.</p>

<p>We wanted to start the remote desktop sessions and then disconnect from them, with the sessions running.  The reason for this was that the machine controlling the tests would end up with 10 to 40 remote desktop sessions and there could be a resource problem.  We tried using Sysinternal.com’s excellant <a href="http://www.sysinternals.com/Utilities/PsExec.html">psxec</a> utility to remotely invoke the HighTest executable.  No matter hoiw we sliced it, it would fail with msg hook error message.    This meant that we had to invoke HighTest from a process running on the remote pc.  After banging a few things around, I created a batch file on the remote pc to launch the HighTest executable and added the the “Scheduled Tasks” list.  That worked, so I disabled the task so it wouldn’t get launched by accident.  The schtasks.exe can be used to run scheduled jobs, even from other machines.  Provided that the machine has an open desktop and is not a disconnected session.  Disconnected sessions do not receive keyboard or mouse input, not even simulated input from HightTest.</p>

<p>We have once more trick up our sleeves.  The remote desktop client (mstsc) can be configured to run a program after you are connected.  If you have the “Remote Desktop Connection” dialog open, click on the “Programs” tab and you will be able to configure the program that you want to run.  We we will do is to have it run a batch file.  That batch file will run the HighTest tool, do any cleanup, and then logout.  And that’s how we plan on running our load tests.</p>

<p>[Edited on 6/14/06]<br />
Scratch the running of programs from the “Remote Desktop Connection” dialog.  That only works if you are connected to a Terminal Server.  You get <a href="http://www.urbandictionary.com/define.php?term=bupkis">bupkis</a> if you use that option with Windows XP.  We are back to looking at using schtasks.exe after starting the remote session with Remote Desktop.</p>

<div>
  Tech Tags: <a href="http://technorati.com/tag/load+testing" rel="tag">load testing</a> <a href="http://technorati.com/tag/mstsc" rel="tag">mstsc</a> <a href="http://technorati.com/tag/Remote+Desktop" rel="tag">Remote Desktop</a> <a href="http://technorati.com/tag/psexec" rel="tag">psexec</a> <a href="http://technorati.com/tag/schtasks" rel="tag">schtasks</a> <a href="http://technorati.com/tag/HighTest+Plus" rel="tag">HighTest Plus</a> <a href="http://technorati.com/tag/Waltham" rel="tag">Waltham</a>
</div>

  </div><a class="u-url" href="/2006/06/13/fun-with-scripted-load-tests/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chris Miller&#39;s 4th Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chris Miller&#39;s 4th Blog</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">anotherlab</span></a></li><li><a href="https://www.twitter.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">anotherlab</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
