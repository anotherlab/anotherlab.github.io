<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Scrolling a ListView’s EditItemTemplate with some help from jQuery | Chris Miller’s 4th Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Scrolling a ListView’s EditItemTemplate with some help from jQuery" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve been using ASP.Net’s ListView control and I cam across a little quirk while setting up the editing bits.  I have an EditItemTemplate defined that has some input controls and a couple of nested ListViews.  It’s a nice way of defining a hierarchal editing view.  If you haven’t used a ListView before, Scott Mitchell have a great tutorial." />
<meta property="og:description" content="I’ve been using ASP.Net’s ListView control and I cam across a little quirk while setting up the editing bits.  I have an EditItemTemplate defined that has some input controls and a couple of nested ListViews.  It’s a nice way of defining a hierarchal editing view.  If you haven’t used a ListView before, Scott Mitchell have a great tutorial." />
<link rel="canonical" href="http://localhost:4000/2011/01/05/scrolling-listviews-edititemtemplate/" />
<meta property="og:url" content="http://localhost:4000/2011/01/05/scrolling-listviews-edititemtemplate/" />
<meta property="og:site_name" content="Chris Miller’s 4th Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-01-05T19:30:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Scrolling a ListView’s EditItemTemplate with some help from jQuery" />
<script type="application/ld+json">
{"datePublished":"2011-01-05T19:30:00-05:00","@type":"BlogPosting","url":"http://localhost:4000/2011/01/05/scrolling-listviews-edititemtemplate/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2011/01/05/scrolling-listviews-edititemtemplate/"},"dateModified":"2011-01-05T19:30:00-05:00","description":"I’ve been using ASP.Net’s ListView control and I cam across a little quirk while setting up the editing bits.  I have an EditItemTemplate defined that has some input controls and a couple of nested ListViews.  It’s a nice way of defining a hierarchal editing view.  If you haven’t used a ListView before, Scott Mitchell have a great tutorial.","headline":"Scrolling a ListView’s EditItemTemplate with some help from jQuery","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Chris Miller's 4th Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chris Miller&#39;s 4th Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Scrolling a ListView’s EditItemTemplate with some help from jQuery</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2011-01-05T19:30:00-05:00" itemprop="datePublished">Jan 5, 2011
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I’ve been using ASP.Net’s <a href="http://msdn.microsoft.com/en-us/library/bb398790.aspx" title="The ASP.NET ListView control enables you to bind to data items that are returned from a data source and display them. You can display data in pages. You can display items individually, or you can group them.">ListView</a> control and I cam across a little quirk while setting up the editing bits.  I have an <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.edititemtemplate.aspx">EditItemTemplate</a> defined that has some input controls and a couple of nested ListViews.  It’s a nice way of defining a hierarchal editing view.  If you haven’t used a ListView before, <a href="http://www.4guysfromrolla.com/ScottMitchell.shtml">Scott Mitchell</a> have a <a href="http://www.4guysfromrolla.com/articles/122607-1.aspx" title="Using ASP.NET 3.5's ListView and DataPager Controls: Displaying Data with the ListView">great tutorial</a>.</p>

<p>My <a href="http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.itemtemplate.aspx" title="Use the ItemTemplate property to define a custom user interface (UI) to display the data items. The ItemTemplate template is required by the ListView control. It usually contains controls to display the field values of a record. If you want to let users modify the data, you also usually add buttons to the ItemTemplate template that let the user select a record, switch to edit mode, or delete a record.">ItemTemplate</a> displays the data for each line of data and has a couple of buttons, one to edit the item, the other to delete it.  When you click the edit button, you get a page refresh and ASP.NET renders the EditItemTemplate with the editing controls and the user can edit the item and save the changes.<br />
The problem was when you needed to scroll down the page to make the EditItemTemplate visible in the browser.  If the height of the ListView was greater than the visible height of the browser, the user would have to scroll down the page to get to the first input control.  I ended up using a bit of <a href="http://jquery.com/" title="jQuery is a fast and concise JavaScript Library that simplifies HTML document traversing, event handling, animating, and Ajax interactions for rapid web development. jQuery is designed to change the way that you write JavaScript.">jQuery</a> to scroll the edit area into view for the user. <br />
This is an edited down version of the EditItemTemplate for a ListView that I’m currently working on:</p>

<pre>&lt;EditItemTemplate&gt;<br />    

<div style="padding: 0 0 10px 0;" class="MyEditItemTemplate">
  <br />        <b>Calendar Name:</b><br />        &lt;asp:TextBox ID="txtCalendarName" runat="server" <br />            Text='&lt;%# Bind("CalendarName") %&gt;'&gt;&lt;/asp:TextBox&gt;<br />        &lt;asp:ImageButton ID="imgbUpdateCalendar" runat="server" <br />            ToolTip="Update Calendar" AlternateText="Update Calendar" <br />            CommandName="Update" <br />            ImageUrl="~/Images/accept.png" /&gt;&nbsp;<br />        &lt;asp:ImageButton ID="imgbCancelUpdate" runat="server" <br />            ToolTip="Cancel" AlternateText="Cancel" <br />            CausesValidation="false" CommandName="Cancel" <br />            ImageUrl="~/Images/cancel.png" /&gt;<br />        <br /><br />        
  
  <div style="padding: 5px 0 0 40px;">
    <br />            
    
    <div style="border: 1px black solid">
      <br />                &lt;asp:ListView ID="ListViewChildCalendars" <br />                    runat="server" DataSourceID="odsChildCalendar"<br />                    DataKeyNames="RecordID" <br />                    InsertItemPosition="FirstItem" <br />                    OnItemInserting="ListViewChildCalendars_ItemInserting"&gt;<br />                    &lt;LayoutTemplate&gt;<br />                        <span class="SubListViewHeader"><strong>Associated Calendars</strong></span><br />                        
      
      <blockquote>
        <br />                            &lt;asp:PlaceHolder runat="server" <br />                            ID="itemPlaceholder"&gt;&lt;/asp:PlaceHolder&gt;<br />                        
      </blockquote>
      
      <br />                    &lt;/LayoutTemplate&gt;<br />                    &lt;ItemSeparatorTemplate&gt;<br />                        
      
      <hr />
      
      <br />                    &lt;/ItemSeparatorTemplate&gt;<br />                    &lt;ItemTemplate&gt;<br />                        &lt;%# Eval("CalendarName") %&gt;&nbsp;<br />                        &lt;asp:ImageButton ID="imgbDeleteCalendar" <br />                            runat="server" <br />                            AlternateText="Remove Calendar from Group" <br />                            ToolTip="Remove Calendar from Group" <br />                            OnClientClick="return DeleteConfirmation('C', this.name);" <br />                            CommandName="Delete" <br />                            ImageUrl="~/Images/delete.png" /&gt;<br />                    &lt;/ItemTemplate&gt;<br />                    &lt;InsertItemTemplate&gt;<br />                        
      
      <div>
        <br />                            <b>Calendar Name: </b><br />                            &lt;asp:DropDownList ID="ddlChildCalendars" <br />                                runat="server" DataSourceID="odsCalendarList"<br />                                DataTextField="CalendarName" <br />                                DataValueField="RecordID"&gt;<br />                            &lt;/asp:DropDownList&gt;<br />                            &nbsp;<br />                            &lt;asp:ImageButton ID="imgbAddChildCalendar" <br />                                runat="server" <br />                                ToolTip="Associate Calendar with Group" <br />                                AlternateText="Associate Calendar with Group" <br />                                CommandName="Insert" <br />                                ImageUrl="~/Images/accept.png" /&gt;<br />                        
      </div>
      
      <br />                    &lt;/InsertItemTemplate&gt;<br />                    &lt;EmptyDataTemplate&gt;<br />                        <span class="SubListViewHeader"><strong>Associated Calendars</strong></span><br />                        
      
      <blockquote>
        <br />                            This list is empty
      </blockquote>
      
      <br />                    &lt;/EmptyDataTemplate&gt;<br />                &lt;/asp:ListView&gt;<br />            
    </div>
    
    <br />        
  </div>
  
  <br />        &lt;asp:ImageButton ID="UsedForScrolling" runat="server" <br />            ImageUrl="~/Images/0.gif" CssClass="UsedForScrolling"/&gt;<br />    
</div>

<br />    <br /><br />&lt;/EditItemTemplate&gt;<br /></pre>

<p>This EditItemTemplate has a nest ListView to associate other items to item currently being edited.  It’s basically a pick list populated from a drop down list.  Since each selection from the list generated a page refresh, it is important to keep the EditItemTemplate displayed on the page.</p>

<p>All of the controls in the EditeItemTemplate are wrapped inside a</p>

<div>
  , with the CSS class name set to “MyEditItemTemplate”.  Defining a CSS class is great for styling, it also makes it very easy to locate controls using jQuery. Also notice the last control in the template, the ImageButton with the ID of “UsedForScrolling”.  It uses an image of an <a href="http://lh6.ggpht.com/_natoSxTaPFU/TSTG0xf-wyI/AAAAAAAAAf0/6yndaOnuAXY/s1600-h/0%5B2%5D.gif">invisible GIF file</a>.  It’s a 1&#215;1 image, with the single pixel set to the transparent color.  The browser will render it (briefly), but it wont be visible.  You can download the GIF from <a href="http://lh6.ggpht.com/_natoSxTaPFU/TSTG0xf-wyI/AAAAAAAAAf0/6yndaOnuAXY/s1600-h/0%5B2%5D.gif">invisible GIF file</a> link.  I had obtained it from <a href="http://www.maproom.co.uk/invis0.htm">a page</a> by Nick Webb.&lt;/p&gt; 
  
  <p>
    You can use the HTML input control instead of an ImageButton, it will not matter too much.  You want to avoid using a control that will render on the screen as a visible item, like a text input control or a check box.  While the code will hide the control after the page has loaded, there would be a flash as the control is rendered, and then removed from the page,  With the invisible GIF, you avoid the brief flash on the page.
  </p>
  
  <p>
    This is how we scroll the edit template so that it’s entirely in view:
  </p>
  
  <p>
  </p>
  
  <ol>
    <li>
      Check for the existence of the invisible button.  It’s only visible when you are editing an item in the ListView.
    </li>
    <li>
      Set the focus to that button.  While it will render as a transparent image, it can still receive the focus.  This will force the browser to scroll the page (if necessary) so that the focused input control is in view.
    </li>
    <li>
      Set the focus to the first input control in the EditItemLayout.
    </li>
    <li>
      Hide the transparent input button.  While you can’t see it, you don’t want the user to be able to select it.
    </li>
  </ol>
  
  <p>
    We implement this with some jQuery code that will do all 4 four steps.  I put the code in a javascript function that I named “ScrollIntoView()” and called that function from the jQuery <a href="http://docs.jquery.com/How_jQuery_Works#Launching_Code_on_Document_Ready" title="Launching Code on Document Ready">ready event</a>.
  </p>
  
  <p>
  </p>
  
  <pre>$(function () {<br />ScrollIntoView();<br />});<br /><br />function ScrollIntoView()<br />{<br />    var TempInputControlForScrolling = $(".UsedForScrolling:input:visible:first");<br />    var FirstEditControl = $(".MyEditItemTemplate input:text:visible:first");<br /><br />if (TempInputControlForScrolling.length)<br />{<br />TempInputControlForScrolling.focus();<br />FirstEditControl.focus();<br />TempInputControlForScrolling.hide();<br />}<br />else {<br />$("input:text:visible:first").focus();<br />}<br />}</pre>
  
  <p>
    The first line in ScrollIntoView() uses a jQuery <a href="http://api.jquery.com/category/selectors/">Selector</a> to match the first visible input control with a CSS class of “UsedForScrolling”.  The next line matches the first visible text input control that is a child of the control with the CSS class of “MyEditItemTemplate”.
  </p>
  
  <p>
    If we found an input control, then the length property of the TempInputControlForScrolling variable will be greater than 0.  If no match had been made, the length will be 0.  With the match, we set the focus to the invisible GIF input button, then set it to the first text edit control, then finally hide the invisible button.  If the .UsedForScrolling selector did not match any controls, which will happen when you are not editing an item in the ListView, then the first text input control on the page will get the focus.
  </p>
</div>

  </div><a class="u-url" href="/2011/01/05/scrolling-listviews-edititemtemplate/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chris Miller&#39;s 4th Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chris Miller&#39;s 4th Blog</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">anotherlab</span></a></li><li><a href="https://www.twitter.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">anotherlab</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
