<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Fun with the MSDE: installing | Chris Miller’s 4th Blog</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Fun with the MSDE: installing" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Dana Epp has posted a request for information about the MSDE on his blog. He wants to install an app that that requires a named instance of the MSDE and wants to include the smallest footprint of the MSDE installer bits. On machines that already have the MSDE, he wants to install an additional named instance and wanted to avoid including the MSDE bits since it was already installed. With SQL Server named instances, you can’t do that. Adding a second instance isn’t a reconfiguration of the existing install of SQL Server/MSDE/Express, it’s a completely separate install. It’s considered to be a separate application by the installer and the OS." />
<meta property="og:description" content="Dana Epp has posted a request for information about the MSDE on his blog. He wants to install an app that that requires a named instance of the MSDE and wants to include the smallest footprint of the MSDE installer bits. On machines that already have the MSDE, he wants to install an additional named instance and wanted to avoid including the MSDE bits since it was already installed. With SQL Server named instances, you can’t do that. Adding a second instance isn’t a reconfiguration of the existing install of SQL Server/MSDE/Express, it’s a completely separate install. It’s considered to be a separate application by the installer and the OS." />
<link rel="canonical" href="http://localhost:4000/2005/11/25/fun-with-msde-installing/" />
<meta property="og:url" content="http://localhost:4000/2005/11/25/fun-with-msde-installing/" />
<meta property="og:site_name" content="Chris Miller’s 4th Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2005-11-25T16:14:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fun with the MSDE: installing" />
<script type="application/ld+json">
{"datePublished":"2005-11-25T16:14:00-05:00","@type":"BlogPosting","url":"http://localhost:4000/2005/11/25/fun-with-msde-installing/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2005/11/25/fun-with-msde-installing/"},"dateModified":"2005-11-25T16:14:00-05:00","description":"Dana Epp has posted a request for information about the MSDE on his blog. He wants to install an app that that requires a named instance of the MSDE and wants to include the smallest footprint of the MSDE installer bits. On machines that already have the MSDE, he wants to install an additional named instance and wanted to avoid including the MSDE bits since it was already installed. With SQL Server named instances, you can’t do that. Adding a second instance isn’t a reconfiguration of the existing install of SQL Server/MSDE/Express, it’s a completely separate install. It’s considered to be a separate application by the installer and the OS.","headline":"Fun with the MSDE: installing","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Chris Miller's 4th Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chris Miller&#39;s 4th Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Fun with the MSDE: installing</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2005-11-25T16:14:00-05:00" itemprop="datePublished">Nov 25, 2005
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Dana Epp has posted a <a href="http://silverstr.ufies.org/blog/archives/000880.html" title="Any MSDE Gurus Out There?">request</a> for information about the MSDE on his blog. He wants to install an app that that requires a named instance of the MSDE and wants to include the smallest footprint of the MSDE installer bits. On machines that already have the MSDE, he wants to install an additional named instance and wanted to avoid including the MSDE bits since it was already installed. With SQL Server named instances, you can’t do that. Adding a second instance isn’t a reconfiguration of the existing install of SQL Server/MSDE/Express, it’s a completely separate install. It’s considered to be a separate application by the installer and the OS.</p>

<p>I’m not sure why Microsoft went that way, but it’s tied to how the Windows Installer works. A Windows Installer file (.msi) installs just one install of itself. If you try running it again, the installer locates itself on the machine and brings the installer up in maintenance mode. It’s not designed to let you install multiple copies of a single application. If you want to do that, you have to go down the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/installing_multiple_instances_with_instance_transforms.asp" title="Installing Multiple Instances with Instance Transforms">multiple instance transform</a> route. A multiple instance transform file (.mst) is basicly the difference between two .msi files. You use the .mst file to change some of the values in a .msi file so that it gets considered to be a different installer by the Windows Installer runtime. By that’s a whole ‘nother story in and of itself.</p>

<p>Because each instance is essentially a separate installation, you don’t want to mess around with the source installer bits. Otherwise, you’ll make it difficult to install patches or upgrades. I’m pretty sure that’s why Microsoft prefers that you to use their executable to install SQL Server/MSDE/Express. If you use the .msi files, then the patches have be generated against the .msi files that you used. If you merged the SQL Server .msi into your .msi, then upgrades to SQL Server on that machine will required your .msi file. Ouch.</p>

<p>Each instance has to have a .mst file, it’s a one to one relationship. I’m not sure what MS is doing under the hood in the SQL Server install process, but my guess is that it’s creating .mst files at runtime when you specify an instance name. Otherwise it have to include X number of .mst files in the package, and if they did that some <a href="http://www.i80s.com/images/twisted_stay_hungry.gif">twisted person</a> would try to install X+1 instances and break the installer. Creating a .mst file on the fly is doable, but it’s not something I would want to implement. When the user specifies a new instance you need to take your .msi installer file, copy it to a new .msi file. Then you modify that .msi file with the instance name, increment a property, and generate a new product GUID. You then generate the .mst file from the difference between the original .msi file and the new one. After that, you delete the new .msi file, it’s no longer needed. Then you call msiexec with the .msi file and the .mst with the appropriate parameters. I’m not sure that you could reliably generate installer patches (.msp files) under that scenario.</p>

<p>I’m not a fan of how Microsoft implemented the multiple instances. When I wrote the server end of e-Link, I used the Windows Installer to install the service. If the user wants to install a second instance of e-Link, they can use an administration utility that I wrote that can register additional instances of the service, but using the same executable. It provides the same functionality to the user, but only requires one set of files. This makes updating the service much easier as the patch only has to target one installed instance.</p>

<p>I can see why MS went along the single instance route with Windows Installer. It prevents the user from accidently installing 8 copies of <a href="http://en.wikipedia.org/wiki/Wumpus">“Hunt the Wumpus”</a>. It makes it easy to allow installers to repair existing installations or modify the original setup. It does makes some tasks extremely difficult for installing. The big thing that I can see what would require multiple installs are web sites. There you could have multiple installations as people usually install a web a couple of times to try different settings, of have “live” and “staging” versions of a site.</p>

<p>If you want to install a web site with Windows Installer multiple times on the same machine, you have a few choices.</p>

<ul>
  <li>
    <p>You could limit the install to a single instance. If the user wants multiple copies of the web site files, they have to do that part manually. We do that with the web gui end of e-Link and we document how to do it. Another way (which I have not tried) would be to rename the web site or virtual directory and it the physical name of the folder that it was installed into. Then run the installer again. It will come up in maintenance mode and you would select repair and it should install another set of files into the previously selected location. The draw to both methods is that the installer will repair or uninstall only the files it knows about. If you add anything manually, then you must remove it manually.</p>
  </li>
  <li>
    <p>You could supply a fixed number of instance transforms. If you do this, you’ll need an intelligent front end application to your installer so that you can prompt the user for the instance name. Then you have to check to see if that instance is already installed. If not, then you get the next available instance number and see if you have enough transfoms to use one for this install. Lots of error checking required here, it’s not something I would want to do.</p>
  </li>
  <li>
    <p>You could generate instance transforms at run time. Much of the same logic as the previous option, plus the additional work of creating the transform. I definitely don’t want to ever have to do this.</p>
  </li>
</ul>
<p>&lt;/ul&gt;</p>

<p>This is why you don’t see many .msi files for installing web sites.<br />
<a href="http://silverstr.ufies.org/blog/mt-tb.cgi?__mode=view&amp;entry_id=880" title="Trackback to Dana's post">Trackback to Dana’s post</a></p>

  </div><a class="u-url" href="/2005/11/25/fun-with-msde-installing/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chris Miller&#39;s 4th Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chris Miller&#39;s 4th Blog</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">anotherlab</span></a></li><li><a href="https://www.twitter.com/anotherlab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">anotherlab</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
